<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Timeline Editor and Overlays | Aura Video Studio </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Timeline Editor and Overlays | Aura Video Studio ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/Coffee285/aura-video-studio/blob/main/docs/features/TIMELINE.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="Aura Video Studio">
            Aura Video Studio
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="timeline-editor-and-overlays">Timeline Editor and Overlays</h1>

<h2 id="overview">Overview</h2>
<p>The Aura Video Studio timeline editor provides professional video editing capabilities including multi-track editing, clip operations, chapter markers, and text overlays.</p>
<h2 id="features">Features</h2>
<h3 id="multi-track-timeline">Multi-Track Timeline</h3>
<p>The timeline consists of four tracks:</p>
<ul>
<li><strong>V1</strong> (Video 1): Primary video track</li>
<li><strong>V2</strong> (Video 2): Secondary video track for compositing</li>
<li><strong>A1</strong> (Audio 1): Primary audio track</li>
<li><strong>A2</strong> (Audio 2): Secondary audio track for music/effects</li>
</ul>
<h3 id="timeline-operations">Timeline Operations</h3>
<h4 id="split-s">Split (S)</h4>
<p>Splits a clip at the playhead position, creating two separate clips.</p>
<p><strong>Usage:</strong></p>
<ol>
<li>Select a clip</li>
<li>Position the playhead where you want to split</li>
<li>Press <code>S</code> or click the Split button</li>
</ol>
<p><strong>Behavior:</strong></p>
<ul>
<li>Creates two clips with adjusted source in/out points</li>
<li>First clip ends at split point, second clip begins at split point</li>
<li>Both clips maintain their original source material</li>
</ul>
<h4 id="ripple-trim">Ripple Trim</h4>
<p>Trims a clip and automatically shifts all subsequent clips to close or open gaps.</p>
<p><strong>Behavior:</strong></p>
<ul>
<li>Adjusts clip in-point or out-point</li>
<li>Shifts all clips after the trimmed clip by the trim delta</li>
<li>Maintains no gaps in the timeline</li>
</ul>
<h4 id="slip">Slip</h4>
<p>Changes the source in/out points of a clip without changing its timeline position or duration.</p>
<p><strong>Behavior:</strong></p>
<ul>
<li>Adjusts which portion of the source material is shown</li>
<li>Timeline position and duration remain unchanged</li>
<li>Useful for adjusting timing within a clip</li>
</ul>
<h4 id="slide">Slide</h4>
<p>Moves a clip along the timeline while adjusting adjacent clips to accommodate the move.</p>
<p><strong>Behavior:</strong></p>
<ul>
<li>Changes the clip's timeline position</li>
<li>Adjusts surrounding clips to fill gaps or make space</li>
<li>Maintains the clip's source in/out points</li>
</ul>
<h4 id="roll">Roll</h4>
<p>Adjusts the edit point between two adjacent clips, extending one and trimming the other.</p>
<p><strong>Behavior:</strong></p>
<ul>
<li>Extends the first clip's out-point</li>
<li>Advances the second clip's in-point</li>
<li>Edit point moves but overall duration stays the same</li>
</ul>
<h3 id="text-overlays">Text Overlays</h3>
<p>Three types of text overlays are supported:</p>
<h4 id="title">Title</h4>
<p>Large, prominent text typically displayed at the top center of the frame.</p>
<p><strong>Default Settings:</strong></p>
<ul>
<li>Font Size: 72px</li>
<li>Position: Top Center</li>
<li>Background: Black with 70% opacity</li>
<li>Border: 2px white</li>
</ul>
<h4 id="lower-third">Lower Third</h4>
<p>Smaller text displayed at the bottom of the frame, often used for speaker names or captions.</p>
<p><strong>Default Settings:</strong></p>
<ul>
<li>Font Size: 36px</li>
<li>Position: Bottom Left</li>
<li>Background: Blue (#000080) with 85% opacity</li>
<li>No border</li>
</ul>
<h4 id="callout">Callout</h4>
<p>Attention-grabbing text used to highlight important information.</p>
<p><strong>Default Settings:</strong></p>
<ul>
<li>Font Size: 48px</li>
<li>Position: Middle Right</li>
<li>Font Color: Yellow</li>
<li>Background: Black with 80% opacity</li>
<li>Border: 3px yellow</li>
</ul>
<h3 id="safe-area-alignment">Safe Area Alignment</h3>
<p>Overlays can be positioned using safe area presets:</p>
<ul>
<li><strong>Top:</strong> Left, Center, Right</li>
<li><strong>Middle:</strong> Left, Center, Right</li>
<li><strong>Bottom:</strong> Left, Center, Right</li>
<li><strong>Custom:</strong> Specify exact X/Y coordinates</li>
</ul>
<p>Safe margins ensure overlays aren't cut off on different displays (50px margin by default).</p>
<h3 id="chapter-markers">Chapter Markers</h3>
<p>Chapter markers create timestamps for video chapters, useful for YouTube and other platforms.</p>
<p><strong>YouTube Format:</strong></p>
<pre><code>0:00 Introduction
2:30 Main Content
15:45 Conclusion
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>Click &quot;Add Marker&quot; to create a chapter at the current playhead position</li>
<li>Markers are automatically sorted by time</li>
<li>Export to YouTube-compatible format</li>
<li>Visual indicators on the timeline ruler</li>
</ul>
<h3 id="keyboard-shortcuts">Keyboard Shortcuts</h3>
<table>
<thead>
<tr>
<th>Key</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Space</code></td>
<td>Play/Pause</td>
</tr>
<tr>
<td><code>J</code></td>
<td>Rewind (not implemented yet)</td>
</tr>
<tr>
<td><code>K</code></td>
<td>Stop (not implemented yet)</td>
</tr>
<tr>
<td><code>L</code></td>
<td>Fast Forward (not implemented yet)</td>
</tr>
<tr>
<td><code>+</code> or <code>=</code></td>
<td>Zoom In</td>
</tr>
<tr>
<td><code>-</code></td>
<td>Zoom Out</td>
</tr>
<tr>
<td><code>S</code></td>
<td>Split Clip at Playhead</td>
</tr>
<tr>
<td><code>Q</code></td>
<td>Seek Backward 1 second</td>
</tr>
<tr>
<td><code>W</code></td>
<td>Seek Forward 1 second</td>
</tr>
</tbody>
</table>
<h3 id="snapping">Snapping</h3>
<p>When enabled, the playhead and clip edges snap to:</p>
<ul>
<li>Clip boundaries (start/end)</li>
<li>Chapter markers</li>
<li>Timeline start (0:00)</li>
</ul>
<p><strong>Snap Threshold:</strong> 100ms (configurable)</p>
<p><strong>Toggle:</strong> Use the Snapping switch in the toolbar</p>
<h3 id="zoom">Zoom</h3>
<p>Adjust the timeline zoom level to view more or less detail:</p>
<ul>
<li><strong>Min:</strong> 10% (0.1x)</li>
<li><strong>Max:</strong> 300% (3.0x)</li>
<li><strong>Default:</strong> 100% (1.0x)</li>
</ul>
<p>Use the zoom slider or <code>+</code>/<code>-</code> keys to adjust.</p>
<h2 id="ffmpeg-integration">FFmpeg Integration</h2>
<h3 id="overlay-rendering">Overlay Rendering</h3>
<p>Text overlays are converted to FFmpeg <code>drawtext</code> filters with the following features:</p>
<p><strong>Culture-Invariant:</strong></p>
<ul>
<li>All numeric values use <code>CultureInfo.InvariantCulture</code></li>
<li>Ensures consistent output across different locales</li>
<li>Time values formatted with 3 decimal places</li>
</ul>
<p><strong>Text Escaping:</strong></p>
<ul>
<li>Special characters are properly escaped for FFmpeg</li>
<li><code>\</code> → <code>\\</code></li>
<li><code>'</code> → <code>\'</code></li>
<li><code>:</code> → <code>\:</code></li>
<li><code>%</code> → <code>\%</code></li>
</ul>
<p><strong>Example Filter:</strong></p>
<pre><code>drawtext=text='My Title':fontsize=72:fontcolor=white:x=960:y=50:box=1:boxcolor=black@0.70:enable='between(t,1.000,5.000)'
</code></pre>
<h3 id="deterministic-output">Deterministic Output</h3>
<p>Overlays are processed in deterministic order:</p>
<ol>
<li>Sort by <code>inTime</code></li>
<li>Sort by <code>id</code> for same time values</li>
<li>Apply filters in sequence</li>
</ol>
<p>This ensures consistent render output for the same timeline configuration.</p>
<h2 id="implementation-details">Implementation Details</h2>
<h3 id="core-c">Core (C#)</h3>
<p><strong>TimelineModel.cs</strong></p>
<ul>
<li>Main timeline state management</li>
<li>Track and clip organization</li>
<li>Undo/redo stack implementation</li>
<li>Snapping logic</li>
</ul>
<p><strong>Operations/*.cs</strong></p>
<ul>
<li>Individual operation implementations</li>
<li>Atomic clip boundary updates</li>
<li>State validation</li>
</ul>
<p><strong>OverlayModel.cs</strong></p>
<ul>
<li>Overlay data model</li>
<li>Position calculation</li>
<li>FFmpeg filter generation</li>
<li>Culture-invariant serialization</li>
</ul>
<p><strong>FFmpegPlanBuilder.cs</strong></p>
<ul>
<li>Extended with <code>BuildFilterGraphWithOverlays</code> method</li>
<li>Integrates overlays into render pipeline</li>
<li>Maintains deterministic ordering</li>
</ul>
<h3 id="frontend-react--typescript">Frontend (React + TypeScript)</h3>
<p><strong>state/timeline.ts</strong></p>
<ul>
<li>Zustand store for timeline state</li>
<li>Client-side operation implementations</li>
<li>Chapter export logic</li>
</ul>
<p><strong>components/Timeline/TimelineView.tsx</strong></p>
<ul>
<li>Visual timeline display</li>
<li>Track and clip rendering</li>
<li>Playhead and marker visualization</li>
<li>Keyboard shortcut handling</li>
</ul>
<p><strong>components/Overlays/OverlayPanel.tsx</strong></p>
<ul>
<li>Overlay creation and editing UI</li>
<li>Style customization</li>
<li>Preview integration</li>
</ul>
<h2 id="testing">Testing</h2>
<h3 id="unit-tests-c">Unit Tests (C#)</h3>
<p><strong>TimelineOperationsTests.cs</strong></p>
<ul>
<li>Split operation validation</li>
<li>Ripple trim with subsequent clips</li>
<li>Slip without position change</li>
<li>Slide with adjacent adjustment</li>
<li>Roll operation between clips</li>
<li>Undo/redo state restoration</li>
<li>Chapter export formatting</li>
<li>Snapping behavior</li>
</ul>
<p><strong>OverlayTests.cs</strong></p>
<ul>
<li>Culture-invariant formatting</li>
<li>Special character escaping</li>
<li>Default overlay creation</li>
<li>Position calculation</li>
<li>FFmpeg filter generation</li>
<li>Deterministic ordering</li>
</ul>
<p><strong>Coverage:</strong> 30 tests, all passing</p>
<h3 id="frontend-tests">Frontend Tests</h3>
<p><strong>Vitest</strong></p>
<ul>
<li>State management operations</li>
<li>Keyboard shortcut dispatch</li>
<li>Overlay mutations</li>
</ul>
<p><strong>Playwright (E2E)</strong></p>
<ul>
<li>Split clip workflow</li>
<li>Add lower-third overlay</li>
<li>Verify render plan JSON</li>
</ul>
<h2 id="best-practices">Best Practices</h2>
<h3 id="timeline-editing">Timeline Editing</h3>
<ol>
<li><strong>Use Snapping:</strong> Keep snapping enabled for precise edits</li>
<li><strong>Keyboard Shortcuts:</strong> Learn shortcuts for faster editing</li>
<li><strong>Undo/Redo:</strong> Don't hesitate to experiment; undo is always available</li>
<li><strong>Zoom:</strong> Zoom in for precise edits, zoom out for overview</li>
</ol>
<h3 id="overlays">Overlays</h3>
<ol>
<li><strong>Timing:</strong> Set appropriate in/out times for readability</li>
<li><strong>Safe Areas:</strong> Use presets to ensure overlays aren't cut off</li>
<li><strong>Contrast:</strong> Ensure text is readable against video content</li>
<li><strong>Consistency:</strong> Use similar styles for overlays of the same type</li>
</ol>
<h3 id="chapter-markers-1">Chapter Markers</h3>
<ol>
<li><strong>Key Moments:</strong> Place markers at significant content changes</li>
<li><strong>Descriptive Titles:</strong> Use clear, concise chapter names</li>
<li><strong>Reasonable Length:</strong> Aim for chapters 2-5 minutes long</li>
<li><strong>Start at Zero:</strong> Always include a marker at 0:00</li>
</ol>
<h2 id="limitations">Limitations</h2>
<ul>
<li>No real-time video preview (UI mockup only)</li>
<li>J/K/L playback controls not yet implemented</li>
<li>Drag-and-drop clip reordering not yet implemented</li>
<li>No waveform visualization for audio tracks</li>
</ul>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="../workflows/UX_GUIDE.html">UX Guide</a></li>
<li><a href="TTS-and-Captions.html">TTS and Captions</a></li>
<li><a href="../developer/BUILD_AND_RUN.html">Build and Run</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/Coffee285/aura-video-studio/blob/main/docs/features/TIMELINE.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          © 2025 Aura Video Studio. Documentation built with DocFX.
        </div>
      </div>
    </footer>
  </body>
</html>
